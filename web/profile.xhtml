<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:ui="http://java.sun.com/jsf/facelets"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:o="http://omnifaces.org/ui"
      xmlns:b="http://bootsfaces.net/ui"
      xmlns:h="http://xmlns.jcp.org/jsf/html">
          
          
    <ui:composition template="template.xhtml">
        <ui:define name="head">
            <title>#{profile.name}</title>
        </ui:define>
            
        <ui:define name="body">
            <b:container>
                <b:panel title="#{profile.name}"
                         collapsible="false"
                         look="primary">
                             
                    <!-- Image and description -->
                    <b:container>
                        <b:row class="show-grid">
                            <b:column col-xs="6" col-md="4">
                                <o:graphicImage value="#{profile.image}"
                                                dataURI="true"
                                                class="img-fluid"/>
                            </b:column>
                            <b:column col-xs="12" col-md="8">
                                <h3>Introduction</h3>
                                <h:outputText value="#{profile.description}"/>
                            </b:column>
                        </b:row>
                    </b:container>
                        
                    <!-- About Me -->
                    <b:container>
                        <h:form>
                            <h3>About Me</h3>
                            <b:panelGrid size="md"
                                         colSpans="3, 9"
                                         columns="2">
                                <h:outputLabel value="Age"/>
                                <h:outputText value="#{profile.ageYears} years, #{profile.ageMonths} months, #{profile.ageWeeks} weeks"/>
                                    
                                <h:outputLabel value="Color"/>
                                <h:outputText value="#{profile.color}"/>
                                    
                                <h:outputLabel value="Sex"/>
                                <h:outputText value="#{profile.sex}"/>
                                    
                                <h:outputLabel value="Weight"/>
                                <h:outputText value="#{profile.weight} lbs"/>
                                    
                                <h:outputLabel value="Energy Level"/>
                                <h:outputText value="#{profile.energyLevel}"/>
                                    
                                <h:outputLabel value="Food Type"/>
                                <h:outputText value="#{profile.foodType}"/>
                                    
                                <h:outputLabel value="Breed"/>
                                <h:outputText value="#{profile.breeds}"/>
                            </b:panelGrid>
                        </h:form>
                    </b:container>
                        
                    <!-- Medical History -->
                    <b:container>
                        <b:tabView activeIndex="0">
                            <b:tab title="Spay/Neuter">
                                <b:label text="#{profile.spay.name}"
                                         severity="danger"
                                         />
                                <h:outputText value="#{profile.spay.description}"
                                              />
                            </b:tab>
                            <b:tab title="Allergies">
                                <ui:repeat value="#{profile.allergies}"
                                           var="allergy">
                                    <h:outputText value="#{allergy.name}"
                                                  class="h5"/>
                                    <br/>
                                    <h:outputText value="#{allergy.description}"
                                                  rendered="#{allergy.hasDescription()}"/>
                                    <br/>
                                    <h:outputText value="#{allergy.action}"
                                                  rendered="#{allergy.hasAction()}"/>
                                    <br/>
                                    <br/>
                                </ui:repeat>
                            </b:tab>
                            <b:tab title="Surgeries">
                                <ui:repeat value="#{profile.surgeries}"
                                           var="surg">
                                    <h:outputText value="#{surg.name}"
                                                  class="h5"/>
                                    <br/>
                                    <h:outputText value="#{surg.description}"
                                                  rendered="#{surg.hasDescription()}"/>
                                    <br/>
                                    <h:outputText value="#{surg.action}"
                                                  rendered="#{surg.hasAction()}"/>
                                    <br/>
                                    <br/>
                                </ui:repeat>
                            </b:tab>
                            <b:tab title="Medical Conditions">
                                <ui:repeat value="#{profile.conditions}"
                                           var="c">
                                    <h:outputText value="#{c.name}"
                                                  class="h4"/>
                                    <br/>
                                    <h:outputText value="#{c.description}"
                                                  rendered="#{c.hasDescription()}"/>
                                    <br/>
                                    <h:outputText value="Recommended action:"
                                                  rendered="#{c.hasAction()}"/>
                                    <h:outputText value="#{c.action}"
                                                  rendered="#{c.hasAction()}"/>
                                    <br/>
                                    <br/>
                                </ui:repeat>
                            </b:tab>
                        </b:tabView>
                    </b:container>
                        
                    <!-- Current Holds/Place a Hold -->
                    <b:container id="holds">
                        <h:form>
                            <h3>Current Holds</h3>
                            <ui:repeat value="#{profile.holds}"
                                       var="h">
                                <p>#{h}</p>
                            </ui:repeat>
                        </h:form>
                    </b:container>
                        
                </b:panel>
                    
                <!-- Hidden employee panel -->
                <b:panel rendered="#{login.isEmployee()}"
                         look="danger"
                         collapsible="false"
                         title="Employee Functions">
                             
                    <!-- Place an adoption. For our purposes,
                         we just need to verify that customer exists
                         and then redirect to a form -->
                    <b:panel title="Adopt"
                             onclick="#{animalform.setId(profile.id)}"
                             collapsed="true"
                             look="success">
                        <h:form>
                            <b:inputText value="#{animalform.customerUsername}"
                                         validator="#{animalform.validateAdopt}"
                                         required="true"
                                         label="Customer Username"/>
                            <b:commandButton  class="btn btn-primary"
                                              ajax="true"
                                              update="@form"
                                              action="#{adoption.checkout(profile, animalform)}"
                                              value="Adopt"/>
                            <b:messages escape="false"/>
                        </h:form>
                    </b:panel>
                        
                    <!-- Place/remove holds.
                         Again, we just want a username, which can be
                         an employee or a customer.
                         Lots of validation needed here -->
                    <b:panel title="Hold"
                             onclick="#{animalform.setId(profile.id)}"
                             collapsed="true"
                             look="warning">
                        <h:form id="formhold">
                            <b:switch value="#{animalform.removing}"
                                      label="Add/Remove"
                                      onText="Remove"
                                      offText="Add"
                                      update="@form"
                                      onColor="danger"
                                      offColor="success"/>
                            <br/>
                            <b:inputText value="#{animalform.customerUsername}"
                                         validator="#{animalform.validateHold}"
                                         required="true"
                                         label="Customer Username"/>
                            <b:commandButton class="btn btn-primary"
                                             ajax="true"
                                             update="@form"
                                             action="#{animalform.buttonAction()}"
                                             value="Submit">
                            </b:commandButton>
                            <b:messages escape="false"/>
                        </h:form>
                    </b:panel>
                        
                    <!-- Modify this animal's About Me section -->
                    <b:panel title="Edit About Me"
                             collapsed="true"
                             onclick="#{animalform.setId(profile.id)}"
                             look="info">
                                 
                    </b:panel>
                        
                    <!-- Add a new medical condition. This is
                         a simple form -->
                    <b:panel title="Add Medical Condition"
                             collapsed="true"
                             onclick="#{animalform.setId(profile.id)}"
                             look="info">
                        <h:form>
                            <b:inputText label="Title"
                                         required="true"
                                         value="#{animalform.conditionTitle}"/>
                            <b:row>
                                <b:column col-md="6">
                                    <b:inputTextarea label="Description"
                                                     required="true"
                                                     value="#{animalform.conditionDesc}"/>
                                </b:column>
                                <b:column col-md="6">
                                    <b:inputTextarea label="Required Action"
                                                     value="#{animalform.conditionAction}"/>
                                </b:column>
                            </b:row>
                            <b:selectOneMenu label="Type of Condition"
                                             required="true"
                                             value="#{animalform.conditionType}"
                                             style="height:3em;">
                                <f:selectItem itemLabel="Allergy"
                                              itemValue="allergy"/>
                                <f:selectItem itemLabel="Surgery"
                                              itemValue="surgery"/>
                                <f:selectItem itemLabel="Spay/Neuter"
                                              itemValue="spay"/>
                                <f:selectItem itemLabel="Condition"
                                              itemValue="condition"/>
                            </b:selectOneMenu>
                            <b:messages/>
                            <b:commandButton class="btn btn-primary"
                                             ajax="true"
                                             update="@form"
                                             action="#{animalform.addCondition()}"
                                             value="Submit"/>
                        </h:form>
                    </b:panel>
                </b:panel>
            </b:container>
        </ui:define>
            
    </ui:composition>
</html>